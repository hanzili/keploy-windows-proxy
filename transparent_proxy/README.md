curl --proxy http://localhost:8080 -k https://google.com

https://docs.mitmproxy.org/stable/howto-transparent/#windows
cmd.exe /c "sc config RemoteAccess start= demand"

run the command at admin previliege.
mitmproxy --mode transparent --showhost -s start.py